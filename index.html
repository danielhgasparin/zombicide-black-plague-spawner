<!DOCTYPE html>

<html>

  <head>
    <meta charset="utf-8"/>
    <title>Zombicide Black Plague Spawner</title>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <script src="js/util.js"></script>
    <script src="js/model.js"></script>
    <script src="js/decks.js"></script>
    <script src="js/logic.js"></script>
    <script>

      function setButtonClick(){
        setGame($("#selectBaseNumberOfSurvivors").val(), $("#selectActualNumberOfSurvivors").val(), $("#checkboxZombieDeckBlackPlague").is(':checked'));
        $("#selectBaseNumberOfSurvivors").prop('disabled', true);
        $("#selectActualNumberOfSurvivors").prop('disabled', true);
        $("#checkboxZombieDeckBlackPlague").prop('disabled', true);
        $("#buttonSet").hide();
        $("#buttonStartNewGame").show();
        $("#radioDangerLevelBlue").prop("checked", true)
        $("#selectNumberOfspawnZones").val(1);
        $("#divSpawnPlaceholder").empty();
        $("#divSpawn").show();
      }

      function startNewGameButtonClick(){
        $("#selectBaseNumberOfSurvivors").prop('disabled', false);
        $("#selectActualNumberOfSurvivors").prop('disabled', false);
        $("#checkboxZombieDeckBlackPlague").prop('disabled', false);
        $("#buttonSet").show();
        $("#buttonStartNewGame").hide();
        $("#divSpawn").hide();
      }

      function spawnButtonClick(){
        let divSpawnPlaceHolder = $("#divSpawnPlaceholder");
        let dangerLevel = parseInt($('input[name=radioDangerLevel]:checked').val());
        let numberOfSpawnZones = $("#selectNumberOfspawnZones").val();
        let spawnZones = spawnZombies(numberOfSpawnZones);
        divSpawnPlaceHolder.empty();
        for(let i = 0; i < spawnZones.length; i++){
          let spawnZone = spawnZones[i];
          let divSpawnZone = $("<div>", {class: ""}).html(writeSpawnZoneHtml(i + 1));
          divSpawnPlaceHolder.append(divSpawnZone, "<br>");
          if(spawnZone != null){
            for(let card of spawnZone){
              let divSpawn = $("<div>", {class: ""}).html(writeSpawnHtml(card, dangerLevel));
              divSpawn.appendTo(divSpawnZone);
            }
          }else{
            let divSpawn = $("<div>", {class: ""}).html(writeSpawnHtml(null, null));
            divSpawn.appendTo(divSpawnZone);
          }
        }
      }

      function writeSpawnZoneHtml(spawnZoneNumber){
        return "<u>---Spawn Zone " + spawnZoneNumber + "---</u>";
      }

      function writeSpawnHtml(card, dangerLevel){
        let html;
        if(card != null){
          let spawn = getSpawnFromCard(card, dangerLevel);
          html = card.number + ": ";
          switch(card.spawnType){
            case SpawnTypeEnum.normalSpawn:
                if(spawn != null){
                  switch(spawn.zombieType){
                    case ZombieTypeEnum.walker:
                      html += "Walker";
                      break;
                    case ZombieTypeEnum.fatty:
                      html += "Fatty";
                      break;
                    case ZombieTypeEnum.runner:
                      html += "Runner";
                      break;
                    case ZombieTypeEnum.abomination:
                      html += "Abomination";
                      break;
                  }
                  html += " x " + spawn.quantity;
                }else{
                  html += "Nothing";
                }
                break;
            case SpawnTypeEnum.extraActivation:
                html += "Extra activation - ";
                if(spawn != null){
                  switch(spawn.zombieType){
                    case ZombieTypeEnum.walker:
                      html += "All Walkers";
                      break;
                    case ZombieTypeEnum.fatty:
                      html += "All Fatties";
                      break;
                    case ZombieTypeEnum.runner:
                      html += "All Runners";
                      break;
                  }
                }else{
                  html += "No one";
                }
                break;
            case SpawnTypeEnum.doubleSpawn:
                html += "Double spawn";
                break;
            case SpawnTypeEnum.necromancerSpawn:
                html += "Necromancer";
                break;
          }
        }else{
          html = "<i>skipped for balance with fewer survivors</i>";
        }
        return html;
      }

    </script>
  </head>

  <body>
    <div>
      <h1>Zombicide Black Plague Spawner</h1>
      <p><i>Work in progress.</i></p>
      <div id="divSetGame">
        <div>
          <label>Base number of survivors
            <select id="selectBaseNumberOfSurvivors">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6" selected>6</option>
            </select>
          </label>
        </div>
        <div>
          <label>Actual number of survivors
            <select id="selectActualNumberOfSurvivors">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6" selected>6</option>
            </select>
          </label>
        </div>
        <div>
          Zombie decks to use
          <label>
            <input type="checkbox" id="checkboxZombieDeckBlackPlague" checked> Black Plague
          </label>
        </div>
        <div>
          <input type="button" id="buttonSet" value="Set" onclick="setButtonClick()">
          <input type="button" id="buttonStartNewGame" value="Start new game" onclick="startNewGameButtonClick()" style="display: none">
        </div>
      </div>
      <br>
      <div id="divSpawn" style="display: none">
        <div>
          Danger level
          <label><input type="radio" id="radioDangerLevelBlue" name="radioDangerLevel" value="1">Blue</label>
          <label><input type="radio" id="radioDangerLevelYellow" name="radioDangerLevel" value="2">Yellow</label>
          <label><input type="radio" id="radioDangerLevelOrange" name="radioDangerLevel" value="3">Orange</label>
          <label><input type="radio" id="radioDangerLevelRed" name="radioDangerLevel" value="4">Red</label>
        </div>
        <div>
          <label>Number of spawn zones
            <select id="selectNumberOfspawnZones">
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </label>
        </div>
        <div>
          <input type="button" value="Spawn" onclick="spawnButtonClick()">
        </div>
        <br>
        <div id="divSpawnPlaceholder"></div>
      </div>
    </div>
  </body>
  
</html>
